import numpy as np
data = {'aapl': {'meta': {'symbol': 'AAPL', 'interval': '1month', 'currency': 'USD', 'exchange_timezone': 'America/New_York', 'exchange': 'NASDAQ', 'mic_code': 'XNGS', 'type': 'Common Stock'}, 'values': [{'datetime': '2023-03-01', 'open': '146.83000', 'high': '162.14000', 'low': '143.89999', 'close': '157.67000', 'volume': '1343398596'}, {'datetime': '2023-02-01', 'open': '143.97000', 'high': '157.38000', 'low': '141.32001', 'close': '147.41000', 'volume': '1286776720'}, {'datetime': '2023-01-01', 'open': '130.28000', 'high': '147.23000', 'low': '124.17000', 'close': '144.28999', 'volume': '1434399420'}, {'datetime': '2022-12-01', 'open': '148.21001', 'high': '150.91991', 'low': '125.87000', 'close': '129.92999', 'volume': '1670415992'}, {'datetime': '2022-11-01', 'open': '155.08000', 'high': '155.45000', 'low': '134.38000', 'close': '148.03000', 'volume': '1724949008'}, {'datetime': '2022-10-01', 'open': '138.21001', 'high': '157.50000', 'low': '134.37000', 'close': '153.34000', 'volume': '1868382000'}, {'datetime': '2022-09-01', 'open': '156.64000', 'high': '164.25999', 'low': '138.00000', 'close': '138.20000', 'volume': '2084776016'}, {'datetime': '2022-08-01', 'open': '161.00999', 'high': '176.14999', 'low': '157.14000', 'close': '157.22000', 'volume': '1510324000'}, {'datetime': '2022-07-01', 'open': '136.03999', 'high': '163.63000', 'low': '135.66000', 'close': '162.50999', 'volume': '1447367000'}, {'datetime': '2022-06-01', 'open': '149.89999', 'high': '151.74001', 'low': '129.03999', 'close': '136.72000', 'volume': '1749296000'}, {'datetime': '2022-05-01', 'open': '156.71001', 'high': '166.48000', 'low': '132.61000', 'close': '148.84000', 'volume': '2401043000'}, {'datetime': '2022-04-01', 'open': '174.03000', 'high': '178.49001', 'low': '155.38000', 'close': '157.64999', 'volume': '1687874000'}, {'datetime': '2022-03-01', 'open': '164.69501', 'high': '179.61000', 'low': '150.10001', 'close': '174.61000', 'volume': '2180880000'}, {'datetime': '2022-02-01', 'open': '174.00999', 'high': '176.64999', 'low': '152.00000', 'close': '165.12000', 'volume': '1629275000'}, {'datetime': '2022-01-01', 'open': '177.83000', 'high': '182.94000', 'low': '154.70000', 'close': '174.78000', 'volume': '2109285008'}, {'datetime': '2021-12-01', 'open': '167.48000', 'high': '182.13000', 'low': '157.80000', 'close': '177.57001', 'volume': '2445627016'}, {'datetime': '2021-11-01', 'open': '148.98500', 'high': '165.70000', 'low': '147.48000', 'close': '165.30000', 'volume': '1691031000'}, {'datetime': '2021-10-01', 'open': '141.89999', 'high': '153.16499', 'low': '138.27000', 'close': '149.80000', 'volume': '1565079000'}, {'datetime': '2021-09-01', 'open': '152.83000', 'high': '157.25999', 'low': '141.27000', 'close': '141.50000', 'volume': '1797946992'}, {'datetime': '2021-08-01', 'open': '146.36000', 'high': '153.49001', 'low': '144.50000', 'close': '151.83000', 'volume': '1463302000'}, {'datetime': '2021-07-01', 'open': '136.60001', 'high': '150.00000', 'low': '135.75999', 'close': '145.86000', 'volume': '1919128000'}, {'datetime': '2021-06-01', 'open': '125.08000', 'high': '137.41000', 'low': '123.13000', 'close': '136.96001', 'volume': '1606588000'}, {'datetime': '2021-05-01', 'open': '132.03999', 'high': '134.07001', 'low': '122.25000', 'close': '124.61000', 'volume': '1711933992'}, {'datetime': '2021-04-01', 'open': '123.66000', 'high': '137.07001', 'low': '122.49000', 'close': '131.46001', 'volume': '1889955992'}, {'datetime': '2021-03-01', 'open': '123.75000', 'high': '128.72000', 'low': '116.21000', 'close': '122.15000', 'volume': '2650847008'}, {'datetime': '2021-02-01', 'open': '133.75000', 'high': '137.87700', 'low': '118.39000', 'close': '121.26000', 'volume': '1834021992'}, {'datetime': '2021-01-01', 'open': '133.52000', 'high': '145.09000', 'low': '126.38200', 'close': '131.96001', 'volume': '2240877992'}, {'datetime': '2020-12-01', 'open': '121.01000', 'high': '138.78900', 'low': '120.01000', 'close': '132.69000', 'volume': '2323295992'}, {'datetime': '2020-11-01', 'open': '109.11000', 'high': '121.99000', 'low': '107.32000', 'close': '119.05000', 'volume': '2123370024'}, {'datetime': '2020-10-01', 'open': '117.64000', 'high': '125.39000', 'low': '107.72000', 'close': '108.86000', 'volume': '2895316992'}, {'datetime': '2020-09-01', 'open': '132.75999', 'high': '137.98000', 'low': '103.10000', 'close': '115.81000', 'volume': '3886792968'}, {'datetime': '2020-08-01', 'open': '108.20000', 'high': '131.00000', 'low': '107.89000', 'close': '129.03999', 'volume': '4070343760'}, {'datetime': '2020-07-01', 'open': '91.28000', 'high': '106.42000', 'low': '89.14000', 'close': '106.26000', 'volume': '3020454728'}, {'datetime': '2020-06-01', 'open': '79.44000', 'high': '93.09000', 'low': '79.30000', 'close': '91.20000', 'volume': '3243603568'}, {'datetime': '2020-05-01', 'open': '71.56000', 'high': '81.06000', 'low': '71.46000', 'close': '79.48000', 'volume': '2806640112'}, {'datetime': '2020-04-01', 'open': '61.62000', 'high': '73.63000', 'low': '59.23000', 'close': '73.45000', 'volume': '3266123240'}, {'datetime': '2020-03-01', 'open': '70.57000', 'high': '76.00000', 'low': '53.15000', 'close': '63.57000', 'volume': '6281326944'}, {'datetime': '2020-02-01', 'open': '76.08000', 'high': '81.81000', 'low': '64.09000', 'close': '68.34000', 'volume': '3020892952'}, {'datetime': '2020-01-01', 'open': '74.06000', 'high': '81.96000', 'low': '73.19000', 'close': '77.38000', 'volume': '2940051448'}, {'datetime': '2019-12-01', 'open': '66.82000', 'high': '73.49000', 'low': '64.07000', 'close': '73.41000', 'volume': '2395485472'}, {'datetime': '2019-11-01', 'open': '62.38000', 'high': '67.00000', 'low': '62.29000', 'close': '66.81000', 'volume': '1795689024'}, {'datetime': '2019-10-01', 'open': '56.27000', 'high': '62.44000', 'low': '53.78000', 'close': '62.19000', 'volume': '2490606784'}, {'datetime': '2019-09-01', 'open': '51.61000', 'high': '56.60000', 'low': '51.05000', 'close': '55.99000', 'volume': '2189633960'}, {'datetime': '2019-08-01', 'open': '53.48000', 'high': '54.51000', 'low': '48.15000', 'close': '52.19000', 'volume': '2734062976'}, {'datetime': '2019-07-01', 'open': '50.79000', 'high': '55.34000', 'low': '49.60000', 'close': '53.26000', 'volume': '1895828488'}, {'datetime': '2019-06-01', 'open': '43.90000', 'high': '50.39000', 'low': '42.57000', 'close': '49.48000', 'volume': '2060875056'}, {'datetime': '2019-05-01', 'open': '52.47000', 'high': '53.83000', 'low': '43.75000', 'close': '43.77000', 'volume': '2957826272'}, {'datetime': '2019-04-01', 'open': '47.91000', 'high': '52.12000', 'low': '47.09000', 'close': '50.17000', 'volume': '2024471240'}, {'datetime': '2019-03-01', 'open': '43.57000', 'high': '49.42000', 'low': '42.38000', 'close': '47.49000', 'volume': '2603925528'}, {'datetime': '2019-02-01', 'open': '41.74000', 'high': '43.97000', 'low': '41.48000', 'close': '43.29000', 'volume': '1890162896'}, {'datetime': '2019-01-01', 'open': '38.72000', 'high': '42.25000', 'low': '35.50000', 'close': '41.61000', 'volume': '3312396696'}, {'datetime': '2018-12-01', 'open': '46.12000', 'high': '46.23000', 'low': '36.65000', 'close': '39.44000', 'volume': '3595667984'}, {'datetime': '2018-11-01', 'open': '54.76000', 'high': '55.59000', 'low': '42.56000', 'close': '44.65000', 'volume': '3845287792'}, {'datetime': '2018-10-01', 'open': '56.99000', 'high': '58.37000', 'low': '51.52000', 'close': '54.72000', 'volume': '3158992304'}, {'datetime': '2018-09-01', 'open': '57.10000', 'high': '57.42000', 'low': '53.83000', 'close': '56.44000', 'volume': '2715888152'}, {'datetime': '2018-08-01', 'open': '49.78000', 'high': '57.22000', 'low': '49.33000', 'close': '56.91000', 'volume': '2801275360'}, {'datetime': '2018-07-01', 'open': '45.95000', 'high': '48.99000', 'low': '45.85000', 'close': '47.57000', 'volume': '1575375544'}, {'datetime': '2018-06-01', 'open': '47.00000', 'high': '48.55000', 'low': '45.18000', 'close': '46.28000', 'volume': '2110497464'}, {'datetime': '2018-05-01', 'open': '41.60000', 'high': '47.59000', 'low': '41.32000', 'close': '46.72000', 'volume': '2483904832'}, {'datetime': '2018-04-01', 'open': '41.97000', 'high': '44.73000', 'low': '40.16000', 'close': '41.31000', 'volume': '2665440568'}], 'status': 'ok'}, 'pltr': {'meta': {'symbol': 'PLTR', 'interval': '1month', 'currency': 'USD', 'exchange_timezone': 'America/New_York', 'exchange': 'NYSE', 'mic_code': 'XNYS', 'type': 'Common Stock'}, 'values': [{'datetime': '2023-03-01', 'open': '7.83000', 'high': '8.62000', 'low': '7.19000', 'close': '8.01000', 'volume': '599807052'}, {'datetime': '2023-02-01', 'open': '7.73000', 'high': '10.31000', 'low': '7.45000', 'close': '7.84000', 'volume': '1277141100'}, {'datetime': '2023-01-01', 'open': '6.58000', 'high': '8.76000', 'low': '5.84000', 'close': '7.78000', 'volume': '606381200'}, {'datetime': '2022-12-01', 'open': '7.51000', 'high': '7.97000', 'low': '5.92000', 'close': '6.42000', 'volume': '626983600'}, {'datetime': '2022-11-01', 'open': '8.99000', 'high': '9.06000', 'low': '6.89000', 'close': '7.50000', 'volume': '813114600'}, {'datetime': '2022-10-01', 'open': '8.14500', 'high': '9.05000', 'low': '7.53000', 'close': '8.79000', 'volume': '664538300'}, {'datetime': '2022-09-01', 'open': '7.61000', 'high': '8.50000', 'low': '7.13000', 'close': '8.13000', 'volume': '757455500'}, {'datetime': '2022-08-01', 'open': '10.25000', 'high': '11.62000', 'low': '7.68000', 'close': '7.72000', 'volume': '904936200'}, {'datetime': '2022-07-01', 'open': '9.11000', 'high': '10.76000', 'low': '8.65000', 'close': '10.35000', 'volume': '711553500'}, {'datetime': '2022-06-01', 'open': '8.72000', 'high': '10.20000', 'low': '7.50000', 'close': '9.07000', 'volume': '826439700'}, {'datetime': '2022-05-01', 'open': '10.38000', 'high': '11.01000', 'low': '6.44000', 'close': '8.68000', 'volume': '1127366900'}, {'datetime': '2022-04-01', 'open': '13.77000', 'high': '14.86000', 'low': '10.36000', 'close': '10.40000', 'volume': '645660400'}, {'datetime': '2022-03-01', 'open': '11.99000', 'high': '14.36000', 'low': '10.27000', 'close': '13.73000', 'volume': '1015571800'}, {'datetime': '2022-02-01', 'open': '14.23000', 'high': '14.37000', 'low': '9.74000', 'close': '11.85000', 'volume': '1301730900'}, {'datetime': '2022-01-01', 'open': '18.36000', 'high': '18.84000', 'low': '11.75000', 'close': '13.71000', 'volume': '1057405800'}, {'datetime': '2021-12-01', 'open': '20.53000', 'high': '20.89000', 'low': '17.81000', 'close': '18.21000', 'volume': '781294500'}, {'datetime': '2021-11-01', 'open': '26.11000', 'high': '27.11000', 'low': '20.05000', 'close': '20.65000', 'volume': '885986000'}, {'datetime': '2021-10-01', 'open': '24.21000', 'high': '26.75000', 'low': '23.02000', 'close': '25.88000', 'volume': '750518600'}, {'datetime': '2021-09-01', 'open': '26.46000', 'high': '29.29000', 'low': '23.88000', 'close': '24.04000', 'volume': '1178728900'}, {'datetime': '2021-08-01', 'open': '21.91000', 'high': '26.60000', 'low': '21.48000', 'close': '26.34000', 'volume': '1091002700'}, {'datetime': '2021-07-01', 'open': '26.10000', 'high': '26.13000', 'low': '20.55000', 'close': '21.71000', 'volume': '579358800'}, {'datetime': '2021-06-01', 'open': '23.19000', 'high': '27.50000', 'low': '22.36000', 'close': '26.36000', 'volume': '1178021600'}, {'datetime': '2021-05-01', 'open': '23.01000', 'high': '24.75000', 'low': '17.05500', 'close': '22.95000', 'volume': '1460052600'}, {'datetime': '2021-04-01', 'open': '23.95000', 'high': '26.20000', 'low': '21.24000', 'close': '23.04000', 'volume': '1012475100'}, {'datetime': '2021-03-01', 'open': '25.19000', 'high': '27.47000', 'low': '20.18000', 'close': '23.29000', 'volume': '1805085500'}, {'datetime': '2021-02-01', 'open': '35.33000', 'high': '39.22000', 'low': '22.70000', 'close': '23.90000', 'volume': '2181517700'}, {'datetime': '2021-01-01', 'open': '23.91000', 'high': '45.00000', 'low': '22.50000', 'close': '35.18000', 'volume': '1244340400'}, {'datetime': '2020-12-01', 'open': '28.09000', 'high': '31.24000', 'low': '21.15000', 'close': '23.55000', 'volume': '1476607700'}, {'datetime': '2020-11-01', 'open': '10.23000', 'high': '33.50000', 'low': '10.23000', 'close': '27.11000', 'volume': '1655174000'}, {'datetime': '2020-10-01', 'open': '9.69000', 'high': '11.10000', 'low': '8.90000', 'close': '10.13000', 'volume': '704629200'}, {'datetime': '2020-09-01', 'open': '10.00000', 'high': '11.41000', 'low': '9.11000', 'close': '9.50000', 'volume': '338584400'}], 'status': 'ok'}}

data1 = {'meta': {'symbol': 'AAPL', 'interval': '1month', 'currency': 'USD', 'exchange_timezone': 'America/New_York', 'exchange': 'NASDAQ', 'mic_code': 'XNGS', 'type': 'Common Stock'}, 'values': [{'datetime': '2023-03-01', 'open': '146.83000', 'high': '162.14000', 'low': '143.89999', 'close': '157.67000', 'volume': '1343398596'}, {'datetime': '2023-02-01', 'open': '143.97000', 'high': '157.38000', 'low': '141.32001', 'close': '147.41000', 'volume': '1286776720'}, {'datetime': '2023-01-01', 'open': '130.28000', 'high': '147.23000', 'low': '124.17000', 'close': '144.28999', 'volume': '1434399420'}, {'datetime': '2022-12-01', 'open': '148.21001', 'high': '150.91991', 'low': '125.87000', 'close': '129.92999', 'volume': '1670415992'}, {'datetime': '2022-11-01', 'open': '155.08000', 'high': '155.45000', 'low': '134.38000', 'close': '148.03000', 'volume': '1724949008'}, {'datetime': '2022-10-01', 'open': '138.21001', 'high': '157.50000', 'low': '134.37000', 'close': '153.34000', 'volume': '1868382000'}, {'datetime': '2022-09-01', 'open': '156.64000', 'high': '164.25999', 'low': '138.00000', 'close': '138.20000', 'volume': '2084776016'}, {'datetime': '2022-08-01', 'open': '161.00999', 'high': '176.14999', 'low': '157.14000', 'close': '157.22000', 'volume': '1510324000'}, {'datetime': '2022-07-01', 'open': '136.03999', 'high': '163.63000', 'low': '135.66000', 'close': '162.50999', 'volume': '1447367000'}, {'datetime': '2022-06-01', 'open': '149.89999', 'high': '151.74001', 'low': '129.03999', 'close': '136.72000', 'volume': '1749296000'}, {'datetime': '2022-05-01', 'open': '156.71001', 'high': '166.48000', 'low': '132.61000', 'close': '148.84000', 'volume': '2401043000'}, {'datetime': '2022-04-01', 'open': '174.03000', 'high': '178.49001', 'low': '155.38000', 'close': '157.64999', 'volume': '1687874000'}, {'datetime': '2022-03-01', 'open': '164.69501', 'high': '179.61000', 'low': '150.10001', 'close': '174.61000', 'volume': '2180880000'}, {'datetime': '2022-02-01', 'open': '174.00999', 'high': '176.64999', 'low': '152.00000', 'close': '165.12000', 'volume': '1629275000'}, {'datetime': '2022-01-01', 'open': '177.83000', 'high': '182.94000', 'low': '154.70000', 'close': '174.78000', 'volume': '2109285008'}, {'datetime': '2021-12-01', 'open': '167.48000', 'high': '182.13000', 'low': '157.80000', 'close': '177.57001', 'volume': '2445627016'}, {'datetime': '2021-11-01', 'open': '148.98500', 'high': '165.70000', 'low': '147.48000', 'close': '165.30000', 'volume': '1691031000'}, {'datetime': '2021-10-01', 'open': '141.89999', 'high': '153.16499', 'low': '138.27000', 'close': '149.80000', 'volume': '1565079000'}, {'datetime': '2021-09-01', 'open': '152.83000', 'high': '157.25999', 'low': '141.27000', 'close': '141.50000', 'volume': '1797946992'}, {'datetime': '2021-08-01', 'open': '146.36000', 'high': '153.49001', 'low': '144.50000', 'close': '151.83000', 'volume': '1463302000'}, {'datetime': '2021-07-01', 'open': '136.60001', 'high': '150.00000', 'low': '135.75999', 'close': '145.86000', 'volume': '1919128000'}, {'datetime': '2021-06-01', 'open': '125.08000', 'high': '137.41000', 'low': '123.13000', 'close': '136.96001', 'volume': '1606588000'}, {'datetime': '2021-05-01', 'open': '132.03999', 'high': '134.07001', 'low': '122.25000', 'close': '124.61000', 'volume': '1711933992'}, {'datetime': '2021-04-01', 'open': '123.66000', 'high': '137.07001', 'low': '122.49000', 'close': '131.46001', 'volume': '1889955992'}, {'datetime': '2021-03-01', 'open': '123.75000', 'high': '128.72000', 'low': '116.21000', 'close': '122.15000', 'volume': '2650847008'}, {'datetime': '2021-02-01', 'open': '133.75000', 'high': '137.87700', 'low': '118.39000', 'close': '121.26000', 'volume': '1834021992'}, {'datetime': '2021-01-01', 'open': '133.52000', 'high': '145.09000', 'low': '126.38200', 'close': '131.96001', 'volume': '2240877992'}, {'datetime': '2020-12-01', 'open': '121.01000', 'high': '138.78900', 'low': '120.01000', 'close': '132.69000', 'volume': '2323295992'}, {'datetime': '2020-11-01', 'open': '109.11000', 'high': '121.99000', 'low': '107.32000', 'close': '119.05000', 'volume': '2123370024'}, {'datetime': '2020-10-01', 'open': '117.64000', 'high': '125.39000', 'low': '107.72000', 'close': '108.86000', 'volume': '2895316992'}, {'datetime': '2020-09-01', 'open': '132.75999', 'high': '137.98000', 'low': '103.10000', 'close': '115.81000', 'volume': '3886792968'}, {'datetime': '2020-08-01', 'open': '108.20000', 'high': '131.00000', 'low': '107.89000', 'close': '129.03999', 'volume': '4070343760'}, {'datetime': '2020-07-01', 'open': '91.28000', 'high': '106.42000', 'low': '89.14000', 'close': '106.26000', 'volume': '3020454728'}, {'datetime': '2020-06-01', 'open': '79.44000', 'high': '93.09000', 'low': '79.30000', 'close': '91.20000', 'volume': '3243603568'}, {'datetime': '2020-05-01', 'open': '71.56000', 'high': '81.06000', 'low': '71.46000', 'close': '79.48000', 'volume': '2806640112'}, {'datetime': '2020-04-01', 'open': '61.62000', 'high': '73.63000', 'low': '59.23000', 'close': '73.45000', 'volume': '3266123240'}, {'datetime': '2020-03-01', 'open': '70.57000', 'high': '76.00000', 'low': '53.15000', 'close': '63.57000', 'volume': '6281326944'}, {'datetime': '2020-02-01', 'open': '76.08000', 'high': '81.81000', 'low': '64.09000', 'close': '68.34000', 'volume': '3020892952'}, {'datetime': '2020-01-01', 'open': '74.06000', 'high': '81.96000', 'low': '73.19000', 'close': '77.38000', 'volume': '2940051448'}, {'datetime': '2019-12-01', 'open': '66.82000', 'high': '73.49000', 'low': '64.07000', 'close': '73.41000', 'volume': '2395485472'}, {'datetime': '2019-11-01', 'open': '62.38000', 'high': '67.00000', 'low': '62.29000', 'close': '66.81000', 'volume': '1795689024'}, {'datetime': '2019-10-01', 'open': '56.27000', 'high': '62.44000', 'low': '53.78000', 'close': '62.19000', 'volume': '2490606784'}, {'datetime': '2019-09-01', 'open': '51.61000', 'high': '56.60000', 'low': '51.05000', 'close': '55.99000', 'volume': '2189633960'}, {'datetime': '2019-08-01', 'open': '53.48000', 'high': '54.51000', 'low': '48.15000', 'close': '52.19000', 'volume': '2734062976'}, {'datetime': '2019-07-01', 'open': '50.79000', 'high': '55.34000', 'low': '49.60000', 'close': '53.26000', 'volume': '1895828488'}, {'datetime': '2019-06-01', 'open': '43.90000', 'high': '50.39000', 'low': '42.57000', 'close': '49.48000', 'volume': '2060875056'}, {'datetime': '2019-05-01', 'open': '52.47000', 'high': '53.83000', 'low': '43.75000', 'close': '43.77000', 'volume': '2957826272'}, {'datetime': '2019-04-01', 'open': '47.91000', 'high': '52.12000', 'low': '47.09000', 'close': '50.17000', 'volume': '2024471240'}, {'datetime': '2019-03-01', 'open': '43.57000', 'high': '49.42000', 'low': '42.38000', 'close': '47.49000', 'volume': '2603925528'}, {'datetime': '2019-02-01', 'open': '41.74000', 'high': '43.97000', 'low': '41.48000', 'close': '43.29000', 'volume': '1890162896'}, {'datetime': '2019-01-01', 'open': '38.72000', 'high': '42.25000', 'low': '35.50000', 'close': '41.61000', 'volume': '3312396696'}, {'datetime': '2018-12-01', 'open': '46.12000', 'high': '46.23000', 'low': '36.65000', 'close': '39.44000', 'volume': '3595667984'}, {'datetime': '2018-11-01', 'open': '54.76000', 'high': '55.59000', 'low': '42.56000', 'close': '44.65000', 'volume': '3845287792'}, {'datetime': '2018-10-01', 'open': '56.99000', 'high': '58.37000', 'low': '51.52000', 'close': '54.72000', 'volume': '3158992304'}, {'datetime': '2018-09-01', 'open': '57.10000', 'high': '57.42000', 'low': '53.83000', 'close': '56.44000', 'volume': '2715888152'}, {'datetime': '2018-08-01', 'open': '49.78000', 'high': '57.22000', 'low': '49.33000', 'close': '56.91000', 'volume': '2801275360'}, {'datetime': '2018-07-01', 'open': '45.95000', 'high': '48.99000', 'low': '45.85000', 'close': '47.57000', 'volume': '1575375544'}, {'datetime': '2018-06-01', 'open': '47.00000', 'high': '48.55000', 'low': '45.18000', 'close': '46.28000', 'volume': '2110497464'}, {'datetime': '2018-05-01', 'open': '41.60000', 'high': '47.59000', 'low': '41.32000', 'close': '46.72000', 'volume': '2483904832'}, {'datetime': '2018-04-01', 'open': '41.97000', 'high': '44.73000', 'low': '40.16000', 'close': '41.31000', 'volume': '2665440568'}], 'status': 'ok'}

monthly_prices={}
monthly_returns={}
arith_mean_returns={}
geo_mean_returns={}
std_deviation={}
portfolio_return=0
weights=np.array([1/2,1/2])

## if len(data)>2 (si on a plusieurs tickers)
for symbol in data.keys():
    monthly_prices[symbol] = np.array([float(value["close"]) for value in data[symbol]["values"]])

for symbol in monthly_prices.keys():
    monthly_returns[symbol] = np.array([(monthly_prices[symbol][i+1]/monthly_prices[symbol][i])-1 for i in range(len(monthly_prices[symbol])-1)])

for symbol in monthly_returns.keys():
    arith_mean_returns[symbol] = round(np.mean(monthly_returns[symbol]), 2)

for symbol in monthly_returns.keys():
    geo_mean_returns[symbol] = round(np.power(np.prod([1+r for r in monthly_returns[symbol]]), 1/len(monthly_returns[symbol]))-1, 2)

for symbol in monthly_prices.keys():
    std_deviation[symbol] = round(np.std(monthly_returns[symbol]), 2)

portfolio_return = np.dot(np.array(list(arith_mean_returns.values())), weights)

# covar_matrix = np.cov(np.array(list(monthly_returns.values())))

# portfolio_var = np.dot(np.transpose(weights), np.dot(covar_matrix, weights))

# print(np.array(list(monthly_returns)))
print(monthly_returns)
